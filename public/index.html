<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Bot 管理系统</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <style>
        body {
            background-color: #f5f5f5;
        }
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            padding: 20px;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .main-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
        }
        .card {
            margin-bottom: 20px;
        }
        .tab-content {
            padding-top: 20px;
        }
        #error-alert, #success-alert {
            display: none;
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1050;
        }
        .loading-spinner {
            display: inline-block;
            width: 1rem;
            height: 1rem;
            border: 0.2em solid currentColor;
            border-right-color: transparent;
            border-radius: 50%;
            animation: spinner-border .75s linear infinite;
        }
        @keyframes spinner-border {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- 登录页 -->
    <div class="container login-container" id="login-container">
        <h2 class="text-center mb-4">Telegram Bot 管理后台登录</h2>
        <div class="mb-3">
            <label for="password" class="form-label">管理密码</label>
            <input type="password" class="form-control" id="password" placeholder="请输入管理密码">
        </div>
        <button class="btn btn-primary w-100" id="login-btn">登录</button>
        <div class="alert alert-danger mt-3" id="login-error" style="display: none;">
            密码错误，请重试
        </div>
        <div class="alert alert-danger mt-3" id="network-error" style="display: none;">
            网络错误，请重试
        </div>
    </div>

    <!-- 主界面 -->
    <div class="container main-container" id="main-container">
        <h2 class="text-center mb-4">Telegram Bot 管理后台</h2>

        <!-- 导航栏 -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="bots-tab" data-bs-toggle="tab" data-bs-target="#bots" type="button">Bot 管理</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="keywords-tab" data-bs-toggle="tab" data-bs-target="#keywords" type="button">关键词回复</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="startmsg-tab" data-bs-toggle="tab" data-bs-target="#startmsg" type="button">启动消息</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="broadcast-tab" data-bs-toggle="tab" data-bs-target="#broadcast" type="button">群发消息</button>
            </li>
            <li class="nav-item ms-auto">
                <button class="btn btn-outline-danger" id="logout-btn">退出登录</button>
            </li>
        </ul>

        <!-- 标签内容 -->
        <div class="tab-content">
            <!-- Bot管理标签 -->
            <div class="tab-pane fade show active" id="bots" role="tabpanel" aria-labelledby="bots-tab">
                <div class="card">
                    <div class="card-header">添加新Bot</div>
                    <div class="card-body">
                        <form id="add-bot-form">
                            <div class="mb-3">
                                <label for="bot-name" class="form-label">Bot 名称</label>
                                <input type="text" class="form-control" id="bot-name" required>
                            </div>
                            <div class="mb-3">
                                <label for="bot-token" class="form-label">Bot Token</label>
                                <input type="text" class="form-control" id="bot-token" required>
                            </div>
                            <div class="mb-3">
                                <label for="bot-admins" class="form-label">管理员ID (多个用英文逗号分隔)</label>
                                <input type="text" class="form-control" id="bot-admins" required>
                            </div>
                            <button type="submit" class="btn btn-primary">添加</button>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">Bot列表</div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Bot名称</th>
                                        <th>管理员ID</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody id="bots-table-body">
                                    <!-- 这里将动态添加Bot列表 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 关键词回复标签 -->
            <div class="tab-pane fade" id="keywords" role="tabpanel" aria-labelledby="keywords-tab">
                <div class="mb-3">
                    <label for="keyword-bot-select" class="form-label">选择 Bot</label>
                    <select class="form-select" id="keyword-bot-select">
                        <!-- 这里将动态添加Bot选项 -->
                    </select>
                </div>

                <div class="card">
                    <div class="card-header">添加关键词回复</div>
                    <div class="card-body">
                        <form id="add-keyword-form">
                            <div class="mb-3">
                                <label class="form-label">匹配类型</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="match-type" id="match-equal" value="equal" checked>
                                    <label class="form-check-label" for="match-equal">
                                        完全匹配
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="match-type" id="match-contain" value="contain">
                                    <label class="form-check-label" for="match-contain">
                                        包含匹配
                                    </label>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="keyword" class="form-label">关键词</label>
                                <input type="text" class="form-control" id="keyword" required>
                            </div>
                            <div class="mb-3">
                                <label for="reply" class="form-label">回复内容</label>
                                <textarea class="form-control" id="reply" rows="3" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">添加</button>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">关键词列表</div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>类型</th>
                                        <th>关键词</th>
                                        <th>回复内容</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody id="keywords-table-body">
                                    <!-- 这里将动态添加关键词列表 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 启动消息标签 -->
            <div class="tab-pane fade" id="startmsg" role="tabpanel" aria-labelledby="startmsg-tab">
                <div class="mb-3">
                    <label for="startmsg-bot-select" class="form-label">选择 Bot</label>
                    <select class="form-select" id="startmsg-bot-select">
                        <!-- 这里将动态添加Bot选项 -->
                    </select>
                </div>

                <div class="card">
                    <div class="card-header">设置启动消息</div>
                    <div class="card-body">
                        <form id="set-startmsg-form">
                            <div class="mb-3">
                                <label class="form-label">消息类型</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="startmsg-type" id="startmsg-text" value="none" checked>
                                    <label class="form-check-label" for="startmsg-text">
                                        纯文本
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="startmsg-type" id="startmsg-photo" value="photo">
                                    <label class="form-check-label" for="startmsg-photo">
                                        图片
                                    </label>
                                </div>
                            </div>
                            <div class="mb-3" id="startmsg-file-url-group" style="display: none;">
                                <label for="startmsg-file-url" class="form-label">图片URL</label>
                                <input type="text" class="form-control" id="startmsg-file-url">
                                <small class="form-text text-muted">请输入已上传的图片URL</small>
                            </div>
                            <div class="mb-3">
                                <label for="startmsg-caption" class="form-label">消息内容</label>
                                <textarea class="form-control" id="startmsg-caption" rows="3" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">保存</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- 群发消息标签 -->
            <div class="tab-pane fade" id="broadcast" role="tabpanel" aria-labelledby="broadcast-tab">
                <div class="mb-3">
                    <label for="broadcast-bot-select" class="form-label">选择 Bot</label>
                    <select class="form-select" id="broadcast-bot-select">
                        <!-- 这里将动态添加Bot选项 -->
                    </select>
                </div>

                <div class="card">
                    <div class="card-header">群发消息</div>
                    <div class="card-body">
                        <form id="broadcast-form">
                            <div class="mb-3">
                                <label class="form-label">消息类型</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="broadcast-type" id="broadcast-text" value="text" checked>
                                    <label class="form-check-label" for="broadcast-text">
                                        纯文本
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="broadcast-type" id="broadcast-photo" value="photo">
                                    <label class="form-check-label" for="broadcast-photo">
                                        图片
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="broadcast-type" id="broadcast-document" value="document">
                                    <label class="form-check-label" for="broadcast-document">
                                        文件
                                    </label>
                                </div>
                            </div>
                            <div class="mb-3" id="broadcast-file-url-group" style="display: none;">
                                <label for="broadcast-file-url" class="form-label">文件URL</label>
                                <input type="text" class="form-control" id="broadcast-file-url">
                                <small class="form-text text-muted">请输入已上传的文件URL</small>
                            </div>
                            <div class="mb-3">
                                <label for="broadcast-text-content" class="form-label">消息内容/图片说明</label>
                                <textarea class="form-control" id="broadcast-text-content" rows="3" required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">发送给所有用户</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 提醒通知 -->
    <div class="alert alert-danger" id="error-alert" role="alert"></div>
    <div class="alert alert-success" id="success-alert" role="alert"></div>

    <!-- 删除确认模态框 -->
    <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteModalLabel">确认删除</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="delete-modal-body">
                    确定要删除吗？
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-danger" id="confirm-delete-btn">确认删除</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
